import{c as e,w as t,n as a,l as s,s as l,m as o,i as n,o as r,b as m,p as d,e as i,d as u,h as c,F as y,r as p,j as b,t as f,I as h,q as _}from"./index-M9oHmXK2.js";import{g as F,p as g,q as C}from"./life.BMHyKRfH.js";import{_ as w}from"./_plugin-vue_export-helper.BCo6x5W8.js";const T=w({name:"PaymentPage",data:()=>({selectedType:null,paymentForm:{number:"",address:"",amount:""},paymentTypes:[{icon:"💡",label:"电费",bgColor:"#FFD700",type:"electric",numberLabel:"电费户号",showAddress:!0},{icon:"💧",label:"水费",bgColor:"#1E90FF",type:"water",numberLabel:"水费户号",showAddress:!0},{icon:"🔥",label:"燃气费",bgColor:"#FF6347",type:"gas",numberLabel:"燃气户号",showAddress:!0},{icon:"📱",label:"话费",bgColor:"#32CD32",type:"phone",numberLabel:"手机号码",showAddress:!1},{icon:"📺",label:"有线电视",bgColor:"#9370DB",type:"tv",numberLabel:"用户编号",showAddress:!0},{icon:"🌐",label:"宽带费",bgColor:"#FF1493",type:"internet",numberLabel:"宽带账号",showAddress:!0}],paymentHistory:[{typeIcon:"💡",title:"电费缴费",detail:"户号: 123456789",amount:"156.80",status:"成功"},{typeIcon:"💧",title:"水费缴费",detail:"户号: 987654321",amount:"89.50",status:"成功"},{typeIcon:"📱",title:"话费充值",detail:"手机: 138****8888",amount:"100.00",status:"成功"}]}),computed:{canSubmit(){return this.paymentForm.number&&this.paymentForm.amount&&(!this.selectedType.showAddress||this.paymentForm.address)}},onLoad(){this.loadPaymentHistory()},methods:{selectPaymentType(e){this.selectedType=e,this.paymentForm={number:"",address:"",amount:""}},async queryBill(){if(this.paymentForm.number)try{s({title:"查询中..."});const e=await C({type:this.selectedType.type,number:this.paymentForm.number,address:this.paymentForm.address});e.amount?(this.paymentForm.amount=e.amount.toString(),l({title:"查询成功",icon:"success"})):l({title:"暂无待缴费用",icon:"none"})}catch(e){l({title:"查询失败，请稍后重试",icon:"none"})}finally{o()}else l({title:`请输入${this.selectedType.numberLabel}`,icon:"none"})},async submitPayment(){if(this.canSubmit)try{s({title:"缴费中..."}),await g({type:this.selectedType.type,number:this.paymentForm.number,address:this.paymentForm.address,amount:parseFloat(this.paymentForm.amount)}),l({title:"缴费成功",icon:"success"}),this.loadPaymentHistory(),this.paymentForm={number:"",address:"",amount:""}}catch(e){l({title:"缴费失败，请稍后重试",icon:"none"})}finally{o()}},async loadPaymentHistory(){try{const e=await F({limit:3});this.paymentHistory=e}catch(e){console.error("加载缴费记录失败:",e)}},viewAllHistory(){a({url:"/pages/payment-history/payment-history"})}}},[["render",function(a,s,l,o,F,g){const C=i,w=n,T=h,k=_;return r(),e(w,{class:"payment-page"},{default:t(()=>[m(w,{class:"page-header"},{default:t(()=>[m(C,{class:"header-title"},{default:t(()=>[u("生活缴费")]),_:1}),m(C,{class:"header-subtitle"},{default:t(()=>[u("水电燃气一键支付")]),_:1})]),_:1}),m(w,{class:"payment-types"},{default:t(()=>[m(w,{class:"types-grid"},{default:t(()=>[(r(!0),c(y,null,p(F.paymentTypes,(a,s)=>(r(),e(w,{class:"type-item",key:s,onClick:e=>g.selectPaymentType(a)},{default:t(()=>[m(w,{class:"type-icon",style:b({backgroundColor:a.bgColor})},{default:t(()=>[m(C,{class:"icon-text"},{default:t(()=>[u(f(a.icon),1)]),_:2},1024)]),_:2},1032,["style"]),m(C,{class:"type-label"},{default:t(()=>[u(f(a.label),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),F.selectedType?(r(),e(w,{key:0,class:"payment-form"},{default:t(()=>[m(w,{class:"form-section"},{default:t(()=>[m(w,{class:"section-title"},{default:t(()=>[m(C,null,{default:t(()=>[u(f(F.selectedType.label)+"缴费",1)]),_:1})]),_:1}),m(w,{class:"form-item"},{default:t(()=>[m(C,{class:"form-label"},{default:t(()=>[u(f(F.selectedType.numberLabel),1)]),_:1}),m(T,{class:"form-input",modelValue:F.paymentForm.number,"onUpdate:modelValue":s[0]||(s[0]=e=>F.paymentForm.number=e),placeholder:`请输入${F.selectedType.numberLabel}`,type:"text"},null,8,["modelValue","placeholder"])]),_:1}),F.selectedType.showAddress?(r(),e(w,{key:0,class:"form-item"},{default:t(()=>[m(C,{class:"form-label"},{default:t(()=>[u("缴费地址")]),_:1}),m(T,{class:"form-input",modelValue:F.paymentForm.address,"onUpdate:modelValue":s[1]||(s[1]=e=>F.paymentForm.address=e),placeholder:"请输入详细地址",type:"text"},null,8,["modelValue"])]),_:1})):d("",!0),m(w,{class:"form-item"},{default:t(()=>[m(C,{class:"form-label"},{default:t(()=>[u("缴费金额")]),_:1}),m(T,{class:"form-input amount-input",modelValue:F.paymentForm.amount,"onUpdate:modelValue":s[2]||(s[2]=e=>F.paymentForm.amount=e),placeholder:"请输入缴费金额",type:"digit"},null,8,["modelValue"])]),_:1})]),_:1}),m(w,{class:"payment-actions"},{default:t(()=>[m(k,{class:"query-btn",onClick:g.queryBill},{default:t(()=>[u("查询账单")]),_:1},8,["onClick"]),m(k,{class:"pay-btn",onClick:g.submitPayment,disabled:!g.canSubmit},{default:t(()=>[u(" 立即缴费 ")]),_:1},8,["onClick","disabled"])]),_:1})]),_:1})):d("",!0),m(w,{class:"payment-history"},{default:t(()=>[m(w,{class:"history-header"},{default:t(()=>[m(C,{class:"history-title"},{default:t(()=>[u("最近缴费记录")]),_:1}),m(C,{class:"view-all",onClick:g.viewAllHistory},{default:t(()=>[u("查看全部")]),_:1},8,["onClick"])]),_:1}),m(w,{class:"history-list"},{default:t(()=>[(r(!0),c(y,null,p(F.paymentHistory,(a,s)=>(r(),e(w,{class:"history-item",key:s},{default:t(()=>[m(w,{class:"record-icon"},{default:t(()=>[m(C,null,{default:t(()=>[u(f(a.typeIcon),1)]),_:2},1024)]),_:2},1024),m(w,{class:"record-info"},{default:t(()=>[m(C,{class:"record-title"},{default:t(()=>[u(f(a.title),1)]),_:2},1024),m(C,{class:"record-detail"},{default:t(()=>[u(f(a.detail),1)]),_:2},1024)]),_:2},1024),m(w,{class:"record-amount"},{default:t(()=>[m(C,{class:"amount"},{default:t(()=>[u("-¥"+f(a.amount),1)]),_:2},1024),m(C,{class:"status"},{default:t(()=>[u(f(a.status),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}],["__scopeId","data-v-b83823eb"]]);export{T as default};
