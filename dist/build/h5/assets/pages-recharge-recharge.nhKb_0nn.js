import{c as e,w as t,n as a,l as s,s as l,m as o,u as c,i as n,o as u,b as r,e as i,d,p as m,I as h,q as p,t as f,h as g,F as _,r as y,k as A}from"./index-M9oHmXK2.js";import{m as v}from"./life.BMHyKRfH.js";import{_ as b}from"./_plugin-vue_export-helper.BCo6x5W8.js";const I=b({name:"RechargePage",data:()=>({activeType:0,selectedAmount:null,customAmount:"",rechargeForm:{phone:""},carrierInfo:{name:"",location:""},rechargeTypes:[{label:"话费充值",type:"phone"},{label:"流量充值",type:"data"}],phoneAmounts:[{value:10,desc:"话费"},{value:20,desc:"话费"},{value:30,desc:"话费"},{value:50,desc:"话费",discount:"95折"},{value:100,desc:"话费",discount:"95折"},{value:200,desc:"话费",discount:"9折"}],dataAmounts:[{value:10,desc:"1GB流量包"},{value:20,desc:"3GB流量包"},{value:30,desc:"5GB流量包"},{value:50,desc:"10GB流量包",discount:"送2GB"},{value:100,desc:"30GB流量包",discount:"送10GB"},{value:150,desc:"50GB流量包",discount:"送20GB"}],rechargeHistory:[{phone:"138****8888",amount:"50",time:"2024-01-15 14:30",status:"成功"},{phone:"139****9999",amount:"100",time:"2024-01-10 09:15",status:"成功"}]}),computed:{currentAmounts(){return 0===this.activeType?this.phoneAmounts:this.dataAmounts},finalAmount(){return this.selectedAmount||this.customAmount||0},canSubmit(){return 11===this.rechargeForm.phone.length&&this.finalAmount>0}},methods:{onPhoneInput(){11===this.rechargeForm.phone.length?this.getCarrierInfo():this.carrierInfo={name:"",location:""}},getCarrierInfo(){const e=this.rechargeForm.phone.substring(0,3);let t="";["130","131","132","155","156","185","186"].includes(e)?t="中国联通":["134","135","136","137","138","139","150","151","152","157","158","159","182","183","184","187","188"].includes(e)?t="中国移动":["133","153","180","181","189"].includes(e)&&(t="中国电信"),this.carrierInfo={name:t,location:"黑龙江 牡丹江"}},switchType(e){this.activeType=e,this.selectedAmount=null,this.customAmount=""},selectAmount(e){this.selectedAmount=e.value,this.customAmount=""},onCustomAmountInput(){this.selectedAmount=null},selectFromContacts(){c({itemList:["138****8888","139****9999","137****7777"],success:e=>{this.rechargeForm.phone=["13812348888","13912349999","13712347777"][e.tapIndex],this.getCarrierInfo()}})},async submitRecharge(){if(this.canSubmit)try{s({title:"充值中..."}),await v({phone:this.rechargeForm.phone,amount:this.finalAmount,type:this.rechargeTypes[this.activeType].type}),l({title:"充值成功",icon:"success"}),this.rechargeHistory.unshift({phone:this.rechargeForm.phone.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"),amount:this.finalAmount.toString(),time:(new Date).toLocaleString(),status:"成功"}),this.rechargeForm.phone="",this.selectedAmount=null,this.customAmount="",this.carrierInfo={name:"",location:""}}catch(e){l({title:"充值失败，请稍后重试",icon:"none"})}finally{o()}},viewAllHistory(){a({url:"/pages/recharge-history/recharge-history"})}}},[["render",function(a,s,l,o,c,v){const b=i,I=n,k=h,C=p;return u(),e(I,{class:"recharge-page"},{default:t(()=>[r(I,{class:"page-header"},{default:t(()=>[r(b,{class:"header-title"},{default:t(()=>[d("手机充值")]),_:1}),r(b,{class:"header-subtitle"},{default:t(()=>[d("话费流量一键充值")]),_:1})]),_:1}),r(I,{class:"recharge-form"},{default:t(()=>[r(I,{class:"form-section"},{default:t(()=>[r(I,{class:"phone-input-section"},{default:t(()=>[r(I,{class:"input-row"},{default:t(()=>[r(k,{class:"phone-input",modelValue:c.rechargeForm.phone,"onUpdate:modelValue":s[0]||(s[0]=e=>c.rechargeForm.phone=e),placeholder:"请输入手机号码",type:"number",maxlength:"11",onInput:v.onPhoneInput},null,8,["modelValue","onInput"]),r(C,{class:"contacts-btn",onClick:v.selectFromContacts},{default:t(()=>[d("📞")]),_:1},8,["onClick"])]),_:1}),c.carrierInfo.name?(u(),e(I,{key:0,class:"carrier-info"},{default:t(()=>[r(b,{class:"carrier-name"},{default:t(()=>[d(f(c.carrierInfo.name),1)]),_:1}),r(b,{class:"carrier-location"},{default:t(()=>[d(f(c.carrierInfo.location),1)]),_:1})]),_:1})):m("",!0)]),_:1}),r(I,{class:"recharge-types"},{default:t(()=>[r(I,{class:"type-tabs"},{default:t(()=>[(u(!0),g(_,null,y(c.rechargeTypes,(a,s)=>(u(),e(I,{class:A(["tab-item",{active:c.activeType===s}]),key:s,onClick:e=>v.switchType(s)},{default:t(()=>[r(b,{class:"tab-text"},{default:t(()=>[d(f(a.label),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1}),r(I,{class:"amount-section"},{default:t(()=>[r(I,{class:"amount-grid"},{default:t(()=>[(u(!0),g(_,null,y(v.currentAmounts,(a,s)=>(u(),e(I,{class:A(["amount-item",{selected:c.selectedAmount===a.value}]),key:s,onClick:e=>v.selectAmount(a)},{default:t(()=>[r(b,{class:"amount-value"},{default:t(()=>[d("¥"+f(a.value),1)]),_:2},1024),a.desc?(u(),e(b,{key:0,class:"amount-desc"},{default:t(()=>[d(f(a.desc),1)]),_:2},1024)):m("",!0),a.discount?(u(),e(I,{key:1,class:"discount-tag"},{default:t(()=>[r(b,{class:"discount-text"},{default:t(()=>[d(f(a.discount),1)]),_:2},1024)]),_:2},1024)):m("",!0)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1}),r(I,{class:"custom-amount"},{default:t(()=>[r(b,{class:"custom-label"},{default:t(()=>[d("自定义金额")]),_:1}),r(k,{class:"custom-input",modelValue:c.customAmount,"onUpdate:modelValue":s[1]||(s[1]=e=>c.customAmount=e),placeholder:"输入其他金额",type:"digit",onInput:v.onCustomAmountInput},null,8,["modelValue","onInput"])]),_:1})]),_:1}),r(I,{class:"recharge-actions"},{default:t(()=>[r(C,{class:"recharge-btn",onClick:v.submitRecharge,disabled:!v.canSubmit},{default:t(()=>[d(" 立即充值 ¥"+f(v.finalAmount),1)]),_:1},8,["onClick","disabled"])]),_:1})]),_:1}),r(I,{class:"recharge-history"},{default:t(()=>[r(I,{class:"history-header"},{default:t(()=>[r(b,{class:"history-title"},{default:t(()=>[d("最近充值记录")]),_:1}),r(b,{class:"view-all",onClick:v.viewAllHistory},{default:t(()=>[d("查看全部")]),_:1},8,["onClick"])]),_:1}),r(I,{class:"history-list"},{default:t(()=>[(u(!0),g(_,null,y(c.rechargeHistory,(a,s)=>(u(),e(I,{class:"history-item",key:s},{default:t(()=>[r(I,{class:"record-info"},{default:t(()=>[r(b,{class:"record-phone"},{default:t(()=>[d(f(a.phone),1)]),_:2},1024),r(b,{class:"record-time"},{default:t(()=>[d(f(a.time),1)]),_:2},1024)]),_:2},1024),r(I,{class:"record-amount"},{default:t(()=>[r(b,{class:"amount"},{default:t(()=>[d("¥"+f(a.amount),1)]),_:2},1024),r(b,{class:"status"},{default:t(()=>[d(f(a.status),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}],["__scopeId","data-v-ca4c90fa"]]);export{I as default};
